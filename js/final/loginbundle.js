"use strict";
/*
 * ATTENTION: The "eval" devtool has been used (maybe by default in mode: "development").
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(self["webpackChunkcompiler"] = self["webpackChunkcompiler"] || []).push([["login"],{

/***/ "./js/basic/jslogin.js":
/*!*****************************!*\
  !*** ./js/basic/jslogin.js ***!
  \*****************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var firebase_auth__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! firebase/auth */ \"./node_modules/firebase/auth/dist/esm/index.esm.js\");\n/* harmony import */ var firebase_firestore__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! firebase/firestore */ \"./node_modules/firebase/firestore/dist/esm/index.esm.js\");\n/* harmony import */ var _general_jsfirebase_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./general/jsfirebase.js */ \"./js/basic/general/jsfirebase.js\");\n/* harmony import */ var _general_jsreusablestructures_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./general/jsreusablestructures.js */ \"./js/basic/general/jsreusablestructures.js\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_general_jsreusablestructures_js__WEBPACK_IMPORTED_MODULE_3__]);\n_general_jsreusablestructures_js__WEBPACK_IMPORTED_MODULE_3__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n// firebase\r\n\r\n\r\n\r\n\r\n\r\n\r\n// global var\r\nlet loginResult;\r\nconst messageContent = document.querySelector(\"#msgCon\");\r\n\r\n\r\n// login user\r\ndocument.getElementById(\"mForm\").addEventListener(\"submit\", loginPerson);\r\n\r\nasync function loginPerson(saveEvent) {\r\n    const loginForm = document.getElementById(\"mForm\");\r\n    saveEvent.preventDefault();\r\n\r\n    // user data\r\n    const userEmail = loginForm.email.value, userPassword = loginForm.passw.value;\r\n    const validationResponse =  await isUserActive(userEmail);\r\n\r\n    if(validationResponse === \"dataIsAcessible\") {\r\n      loginResult = await (0,firebase_auth__WEBPACK_IMPORTED_MODULE_0__.signInWithEmailAndPassword)(_general_jsfirebase_js__WEBPACK_IMPORTED_MODULE_2__.auth, userEmail, userPassword)\r\n      .then(() => { return \"cor\";})\r\n      .catch((error) => {\r\n        console.log(error.code);\r\n        return \"inc\";\r\n      });\r\n    \r\n    } else{\r\n      loginResult = \"inc\";\r\n    \r\n    } \r\n\r\n    showMsg(loginResult);\r\n}\r\n\r\nasync function isUserActive(receivedEmail) {\r\n  const userInformation = {collectionVariable: _general_jsfirebase_js__WEBPACK_IMPORTED_MODULE_2__.usersCol, fieldName: \"email\", fieldValue: receivedEmail};\r\n  const thisUserData = await (0,_general_jsreusablestructures_js__WEBPACK_IMPORTED_MODULE_3__.obtainDocumentDataFromField)(userInformation);\r\n\r\n  let response;\r\n\r\n  if(thisUserData && thisUserData.active === true && thisUserData.deleted === false) {\r\n    response = \"dataIsAcessible\"\r\n\r\n  } else if(!thisUserData) {\r\n    response = \"dataDoesntExists\"\r\n\r\n  } else {\r\n    response = \"dataIsNotAcessible\"\r\n  }\r\n\r\n  console.log(response);\r\n\r\n  return response;\r\n}\r\n\r\n\r\n// show and close message box\r\ndocument.getElementById(\"closeMsgB\").addEventListener(\"click\", closeMsg);\r\n\r\n\r\nfunction showMsg(msgObtained) {\r\n  // var\r\n  const msgType = document.querySelector(\"h1#msgT\");\r\n  const msgData = document.querySelector(\"p#msgD\");\r\n  const msgIcon = document.querySelector(\"img#msgIco\");\r\n\r\n  // is the login correct?\r\n  if(msgObtained == \"cor\") {\r\n    loginCor();\r\n\r\n  } else {\r\n    loginInc();\r\n  }\r\n\r\n\r\n  // compl\r\n  function loginCor() {\r\n    setClass()\r\n\r\n    msgIcon.setAttribute(\"src\", \"../media/ico/login/ico-verify.svg\");\r\n    \r\n    msgType.innerHTML = \"Login concluÃ­do\"\r\n    msgData.textContent = \"Feche essa tela para acessar sua conta.\"\r\n\r\n    messageContent.style.display = \"flex\"\r\n  }\r\n\r\n\r\n\r\n  function loginInc() {\r\n    setClass()\r\n\r\n    msgIcon.setAttribute(\"src\", \"../media/ico/login/ico-error.svg\");\r\n   \r\n    msgType.textContent = \"Erro\"\r\n    msgData.textContent = \"Dados incorretos\"\r\n\r\n    messageContent.style.display = \"flex\"\r\n  }\r\n\r\n\r\n\r\n  function setClass() {\r\n    // remove oposite class\r\n    if(msgObtained == \"cor\" && msgType.classList.contains(\"inc\")) {\r\n        msgType.classList.remove(\"inc\");  \r\n\r\n    } else if(msgObtained == \"inc\" && msgType.classList.contains(\"cor\")) {\r\n      msgType.classList.remove(\"cor\");  \r\n    }\r\n\r\n    // addClass\r\n    msgType.classList.add(msgObtained);  \r\n  }\r\n}\r\n\r\n\r\nfunction closeMsg(){\r\n  messageContent.style.display = \"none\"\r\n\r\n  if(loginResult == \"cor\") {\r\n    window.location.href = \"./html/main.html?currentpage=home\"\r\n  }\r\n\r\n}\r\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });\n\n//# sourceURL=webpack://compiler/./js/basic/jslogin.js?");

/***/ })

},
/******/ __webpack_require__ => { // webpackRuntimeModules
/******/ var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
/******/ var __webpack_exports__ = (__webpack_exec__("./js/basic/jslogin.js"), __webpack_exec__("./js/basic/general/jsreusablestructures.js"));
/******/ }
]);